module Crabstone
  module ARM64
    REG_LOOKUP= {
      "INVALID"=> 0,
      "NZCV"=> 1,
      "WSP"=> 2,
      "SP"=> 3,
      "B0"=> 4,
      "B1"=> 5,
      "B2"=> 6,
      "B3"=> 7,
      "B4"=> 8,
      "B5"=> 9,
      "B6"=> 10,
      "B7"=> 11,
      "B8"=> 12,
      "B9"=> 13,
      "B10"=> 14,
      "B11"=> 15,
      "B12"=> 16,
      "B13"=> 17,
      "B14"=> 18,
      "B15"=> 19,
      "B16"=> 20,
      "B17"=> 21,
      "B18"=> 22,
      "B19"=> 23,
      "B20"=> 24,
      "B21"=> 25,
      "B22"=> 26,
      "B23"=> 27,
      "B24"=> 28,
      "B25"=> 29,
      "B26"=> 30,
      "B27"=> 31,
      "B28"=> 32,
      "B29"=> 33,
      "B30"=> 34,
      "B31"=> 35,
      "D0"=> 36,
      "D1"=> 37,
      "D2"=> 38,
      "D3"=> 39,
      "D4"=> 40,
      "D5"=> 41,
      "D6"=> 42,
      "D7"=> 43,
      "D8"=> 44,
      "D9"=> 45,
      "D10"=> 46,
      "D11"=> 47,
      "D12"=> 48,
      "D13"=> 49,
      "D14"=> 50,
      "D15"=> 51,
      "D16"=> 52,
      "D17"=> 53,
      "D18"=> 54,
      "D19"=> 55,
      "D20"=> 56,
      "D21"=> 57,
      "D22"=> 58,
      "D23"=> 59,
      "D24"=> 60,
      "D25"=> 61,
      "D26"=> 62,
      "D27"=> 63,
      "D28"=> 64,
      "D29"=> 65,
      "D30"=> 66,
      "D31"=> 67,
      "H0"=> 68,
      "H1"=> 69,
      "H2"=> 70,
      "H3"=> 71,
      "H4"=> 72,
      "H5"=> 73,
      "H6"=> 74,
      "H7"=> 75,
      "H8"=> 76,
      "H9"=> 77,
      "H10"=> 78,
      "H11"=> 79,
      "H12"=> 80,
      "H13"=> 81,
      "H14"=> 82,
      "H15"=> 83,
      "H16"=> 84,
      "H17"=> 85,
      "H18"=> 86,
      "H19"=> 87,
      "H20"=> 88,
      "H21"=> 89,
      "H22"=> 90,
      "H23"=> 91,
      "H24"=> 92,
      "H25"=> 93,
      "H26"=> 94,
      "H27"=> 95,
      "H28"=> 96,
      "H29"=> 97,
      "H30"=> 98,
      "H31"=> 99,
      "Q0"=> 100,
      "Q1"=> 101,
      "Q2"=> 102,
      "Q3"=> 103,
      "Q4"=> 104,
      "Q5"=> 105,
      "Q6"=> 106,
      "Q7"=> 107,
      "Q8"=> 108,
      "Q9"=> 109,
      "Q10"=> 110,
      "Q11"=> 111,
      "Q12"=> 112,
      "Q13"=> 113,
      "Q14"=> 114,
      "Q15"=> 115,
      "Q16"=> 116,
      "Q17"=> 117,
      "Q18"=> 118,
      "Q19"=> 119,
      "Q20"=> 120,
      "Q21"=> 121,
      "Q22"=> 122,
      "Q23"=> 123,
      "Q24"=> 124,
      "Q25"=> 125,
      "Q26"=> 126,
      "Q27"=> 127,
      "Q28"=> 128,
      "Q29"=> 129,
      "Q30"=> 130,
      "Q31"=> 131,
      "S0"=> 132,
      "S1"=> 133,
      "S2"=> 134,
      "S3"=> 135,
      "S4"=> 136,
      "S5"=> 137,
      "S6"=> 138,
      "S7"=> 139,
      "S8"=> 140,
      "S9"=> 141,
      "S10"=> 142,
      "S11"=> 143,
      "S12"=> 144,
      "S13"=> 145,
      "S14"=> 146,
      "S15"=> 147,
      "S16"=> 148,
      "S17"=> 149,
      "S18"=> 150,
      "S19"=> 151,
      "S20"=> 152,
      "S21"=> 153,
      "S22"=> 154,
      "S23"=> 155,
      "S24"=> 156,
      "S25"=> 157,
      "S26"=> 158,
      "S27"=> 159,
      "S28"=> 160,
      "S29"=> 161,
      "S30"=> 162,
      "S31"=> 163,
      "W0"=> 164,
      "W1"=> 165,
      "W2"=> 166,
      "W3"=> 167,
      "W4"=> 168,
      "W5"=> 169,
      "W6"=> 170,
      "W7"=> 171,
      "W8"=> 172,
      "W9"=> 173,
      "W10"=> 174,
      "W11"=> 175,
      "W12"=> 176,
      "W13"=> 177,
      "W14"=> 178,
      "W15"=> 179,
      "W16"=> 180,
      "W17"=> 181,
      "W18"=> 182,
      "W19"=> 183,
      "W20"=> 184,
      "W21"=> 185,
      "W22"=> 186,
      "W23"=> 187,
      "W24"=> 188,
      "W25"=> 189,
      "W26"=> 190,
      "W27"=> 191,
      "W28"=> 192,
      "W29"=> 193,
      "W30"=> 194,
      "X0"=> 195,
      "X1"=> 196,
      "X2"=> 197,
      "X3"=> 198,
      "X4"=> 199,
      "X5"=> 200,
      "X6"=> 201,
      "X7"=> 202,
      "X8"=> 203,
      "X9"=> 204,
      "X10"=> 205,
      "X11"=> 206,
      "X12"=> 207,
      "X13"=> 208,
      "X14"=> 209,
      "X15"=> 210,
      "X16"=> 211,
      "X17"=> 212,
      "X18"=> 213,
      "X19"=> 214,
      "X20"=> 215,
      "X21"=> 216,
      "X22"=> 217,
      "X23"=> 218,
      "X24"=> 219,
      "X25"=> 220,
      "X26"=> 221,
      "X27"=> 222,
      "X28"=> 223,
      "X29"=> 224,
      "X30"=> 225,
      # Aliases
      "IP1" => 211,
      "IP0" => 212,
      "FP" => 224,
      "LR" => 225,
      "XZR" => 3,
      "WZR" => 2
    }

    ID_LOOKUP = REG_LOOKUP.invert
    SYM_LOOKUP = Hash[REG_LOOKUP.map {|k,v| [k.downcase.to_sym,v]}]

    def self.register reg
      return reg if ID_LOOKUP[reg]
      return SYM_LOOKUP[reg] if SYM_LOOKUP[reg]
      if reg.respond_to? :upcase
        return REG_LOOKUP[reg.upcase] || REG_LOOKUP['INVALID']
      end
      REG_LOOKUP['INVALID']
    end

  end
end
