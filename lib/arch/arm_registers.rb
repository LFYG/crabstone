module Crabstone
  module ARM
    REG_LOOKUP = {
      "INVALID"   => 0,
      "APSR"      => 1,
      "APSR_NZCV" => 2,
      "CPSR"      => 3,
      "FPEXC"     => 4,
      "FPINST"    => 5,
      "FPSCR"     => 6,
      "FPSCR_NZCV"=> 7,
      "FPSID"     => 8,
      "ITSTATE"   => 9,
      "LR"        => 10,
      "PC"        => 11,
      "SP"        => 12,
      "SPSR"      => 13,
      "D0"        => 14,
      "D1"        => 15,
      "D2"        => 16,
      "D3"        => 17,
      "D4"        => 18,
      "D5"        => 19,
      "D6"        => 20,
      "D7"        => 21,
      "D8"        => 22,
      "D9"        => 23,
      "D10"       => 24,
      "D11"       => 25,
      "D12"       => 26,
      "D13"       => 27,
      "D14"       => 28,
      "D15"       => 29,
      "D16"       => 30,
      "D17"       => 31,
      "D18"       => 32,
      "D19"       => 33,
      "D20"       => 34,
      "D21"       => 35,
      "D22"       => 36,
      "D23"       => 37,
      "D24"       => 38,
      "D25"       => 39,
      "D26"       => 40,
      "D27"       => 41,
      "D28"       => 42,
      "D29"       => 43,
      "D30"       => 44,
      "D31"       => 45,
      "FPINST2"   => 46,
      "MVFR0"     => 47,
      "MVFR1"     => 48,
      "Q0"        => 49,
      "Q1"        => 50,
      "Q2"        => 51,
      "Q3"        => 52,
      "Q4"        => 53,
      "Q5"        => 54,
      "Q6"        => 55,
      "Q7"        => 56,
      "Q8"        => 57,
      "Q9"        => 58,
      "Q10"       => 59,
      "Q11"       => 60,
      "Q12"       => 61,
      "Q13"       => 62,
      "Q14"       => 63,
      "Q15"       => 64,
      "R0"        => 65,
      "R1"        => 66,
      "R2"        => 67,
      "R3"        => 68,
      "R4"        => 69,
      "R5"        => 70,
      "R6"        => 71,
      "R7"        => 72,
      "R8"        => 73,
      "R9"        => 74,
      "R10"       => 75,
      "R11"       => 76,
      "R12"       => 77,
      "S0"        => 78,
      "S1"        => 79,
      "S2"        => 80,
      "S3"        => 81,
      "S4"        => 82,
      "S5"        => 83,
      "S6"        => 84,
      "S7"        => 85,
      "S8"        => 86,
      "S9"        => 87,
      "S10"       => 88,
      "S11"       => 89,
      "S12"       => 90,
      "S13"       => 91,
      "S14"       => 92,
      "S15"       => 93,
      "S16"       => 94,
      "S17"       => 95,
      "S18"       => 96,
      "S19"       => 97,
      "S20"       => 98,
      "S21"       => 99,
      "S22"       => 100,
      "S23"       => 101,
      "S24"       => 102,
      "S25"       => 103,
      "S26"       => 104,
      "S27"       => 105,
      "S28"       => 106,
      "S29"       => 107,
      "S30"       => 108,
      "S31"       => 109
    }

    ID_LOOKUP = REG_LOOKUP.invert
    SYM_LOOKUP = Hash[REG_LOOKUP.map {|k,v| [k.downcase.to_sym,v]}]

    def self.register reg
      return reg if ID_LOOKUP[reg]
      return SYM_LOOKUP[reg] if SYM_LOOKUP[reg]
      if reg.respond_to? :upcase
        return REG_LOOKUP[reg.upcase] || REG_LOOKUP['INVALID']
      end
      REG_LOOKUP['INVALID']
    end

  end
end
